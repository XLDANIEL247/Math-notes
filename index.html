<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loading...</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COVER SCREEN â€” looks like a stuck loading page
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#cover {
  position: fixed;
  inset: 0;
  background: #f1f3f4;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 18px;
  z-index: 99999;
  font-family: 'Google Sans', Arial, sans-serif;
}

.cover-spinner {
  width: 48px;
  height: 48px;
  border: 4px solid #e0e0e0;
  border-top-color: #4285f4;
  border-radius: 50%;
  animation: cspin 0.9s linear infinite;
}
@keyframes cspin { to { transform: rotate(360deg); } }

.cover-text {
  font-size: 14px;
  color: #5f6368;
  letter-spacing: 0.2px;
}

/* Hidden password field â€” type password on cover, nothing shows */
#coverPass {
  position: absolute;
  opacity: 0;
  pointer-events: none;
  width: 1px;
  height: 1px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN APP â€” hidden until unlocked
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#app {
  display: none;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

:root {
  --g: #00ff88;
  --b: #00cfff;
  --p: #ff00aa;
  --y: #ffcc00;
  --dark: #060910;
  --card: #0c1220;
  --card2: #0f1628;
  --border: rgba(0,255,136,0.15);
  --text: #a0b8cc;
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  background: var(--dark);
  font-family: 'Share Tech Mono', monospace;
  color: var(--text);
}

body::after {
  content:'';
  position:fixed;
  inset:0;
  background: repeating-linear-gradient(transparent,transparent 2px,rgba(0,0,0,0.1) 2px,rgba(0,0,0,0.1) 4px);
  pointer-events:none;
  z-index:9998;
  opacity:.3;
}
body::before {
  content:'';
  position:fixed;
  inset:0;
  background-image: linear-gradient(rgba(0,255,136,.03) 1px,transparent 1px),linear-gradient(90deg,rgba(0,255,136,.03) 1px,transparent 1px);
  background-size:44px 44px;
  pointer-events:none;
  z-index:0;
}

/* â”€â”€ TOPBAR â”€â”€ */
#topbar {
  position:relative;
  z-index:100;
  display:flex;
  align-items:center;
  height:52px;
  background:rgba(6,9,16,.97);
  border-bottom:1px solid rgba(0,255,136,.12);
  flex-shrink:0;
}

.logo {
  font-family:'Orbitron',sans-serif;
  font-weight:900;
  font-size:1.1rem;
  letter-spacing:4px;
  color:var(--g);
  text-shadow:0 0 20px var(--g);
  padding:0 24px;
  white-space:nowrap;
  animation:flicker 6s infinite;
}
.logo span{color:var(--b);}
@keyframes flicker{0%,94%,100%{opacity:1}95%{opacity:.6}97%{opacity:.9}98%{opacity:.5}99%{opacity:1}}

#navtabs { display:flex; height:100%; flex:1; }

.navtab {
  display:flex; align-items:center; gap:7px;
  padding:0 20px;
  font-size:.72rem; letter-spacing:2px; text-transform:uppercase;
  color:#556677; cursor:pointer; border:none; background:none;
  font-family:'Share Tech Mono',monospace; height:100%;
  border-bottom:2px solid transparent; transition:all .2s; white-space:nowrap;
}
.navtab:hover { color:var(--g); background:rgba(0,255,136,.04); }
.navtab.active { color:var(--g); border-bottom-color:var(--g); background:rgba(0,255,136,.06); }

.badge-online {
  font-size:.6rem; letter-spacing:1px; color:var(--g);
  background:rgba(0,255,136,.1); border:1px solid rgba(0,255,136,.3);
  border-radius:2px; padding:4px 10px; white-space:nowrap; margin-right:16px;
}

/* â”€â”€ MAIN â”€â”€ */
#main { display:flex; flex:1; overflow:hidden; position:relative; z-index:1; }

.page { display:none; flex:1; overflow:hidden; flex-direction:column; }
.page.active { display:flex; }

/* â”€â”€ GAMES â”€â”€ */
#page-games { flex-direction:row; }
#gamesSidebar {
  width:155px; background:rgba(12,18,32,.8); border-right:1px solid var(--border);
  display:flex; flex-direction:column; gap:4px; padding:14px 8px; overflow-y:auto; flex-shrink:0;
}
.cat-pill {
  background:none; border:none; color:#446688; font-family:'Share Tech Mono',monospace;
  font-size:.63rem; letter-spacing:2px; text-transform:uppercase; padding:8px 10px;
  border-radius:3px; cursor:pointer; text-align:left; transition:all .2s;
}
.cat-pill:hover { color:var(--g); background:rgba(0,255,136,.06); }
.cat-pill.active { color:var(--g); background:rgba(0,255,136,.1); border-left:2px solid var(--g); }

#gamesMain { flex:1; overflow:hidden; display:flex; flex-direction:column; }

.games-back {
  display:none; align-items:center; gap:12px; padding:10px 16px;
  background:rgba(0,0,0,.5); border-bottom:1px solid var(--border);
}
.games-back button {
  background:none; border:1px solid rgba(255,0,170,.3); color:var(--p);
  padding:5px 14px; font-family:'Share Tech Mono',monospace; font-size:.65rem;
  letter-spacing:2px; border-radius:2px; cursor:pointer;
}
.games-back span { font-size:.75rem; color:#aaa; }

#searchBar {
  padding:12px 16px; border-bottom:1px solid var(--border); display:flex; gap:10px;
}
#gameSearch {
  flex:1; background:rgba(0,255,136,.04); border:1px solid var(--border);
  border-radius:3px; color:var(--g); font-family:'Share Tech Mono',monospace;
  font-size:.73rem; padding:8px 12px; outline:none; letter-spacing:1px;
}
#gameSearch::placeholder { color:#334455; }
#gameSearch:focus { border-color:var(--g); box-shadow:0 0 12px rgba(0,255,136,.12); }

#gamesContent { flex:1; overflow-y:auto; padding:18px; }
#gamesFrame { flex:1; border:none; width:100%; background:#000; display:none; }

.games-grid {
  display:grid; grid-template-columns:repeat(auto-fill,minmax(155px,1fr)); gap:13px;
}
.game-card {
  background:var(--card); border:1px solid rgba(0,255,136,.08); border-radius:6px;
  overflow:hidden; cursor:pointer; transition:transform .2s, border-color .2s, box-shadow .2s;
}
.game-card:hover { transform:translateY(-3px); border-color:var(--g); box-shadow:0 6px 24px rgba(0,255,136,.15); }
.game-thumb {
  width:100%; aspect-ratio:16/9; display:flex; align-items:center; justify-content:center;
  font-size:2rem; position:relative; overflow:hidden; background:linear-gradient(135deg,#0a1020,#060b18);
}
.game-thumb::after {
  content:'â–¶ PLAY'; position:absolute; inset:0; background:rgba(0,255,136,.88);
  display:flex; align-items:center; justify-content:center; font-family:'Orbitron',sans-serif;
  font-size:.72rem; font-weight:900; color:#050810; letter-spacing:3px; opacity:0; transition:opacity .2s;
}
.game-card:hover .game-thumb::after { opacity:1; }
.game-info { padding:9px 11px; }
.game-name { font-family:'Orbitron',sans-serif; font-size:.6rem; font-weight:700; color:#c0d8ff; letter-spacing:1px; margin-bottom:3px; }
.game-meta { display:flex; justify-content:space-between; font-size:.57rem; color:#446688; }
.game-rating { color:#ffcc44; }

/* â”€â”€ MUSIC â”€â”€ */
#page-music { flex-direction:row; }
#musicSidebar {
  width:235px; background:rgba(8,12,26,.9); border-right:1px solid rgba(0,207,255,.12);
  display:flex; flex-direction:column; overflow:hidden; flex-shrink:0;
}
.music-sidebar-header { padding:18px 14px 10px; font-family:'Orbitron',sans-serif; font-size:.63rem; color:var(--b); letter-spacing:3px; border-bottom:1px solid rgba(0,207,255,.1); }
#musicSearch {
  margin:10px; background:rgba(0,207,255,.05); border:1px solid rgba(0,207,255,.15);
  border-radius:3px; color:var(--b); font-family:'Share Tech Mono',monospace; font-size:.7rem;
  padding:8px 10px; outline:none; letter-spacing:1px; width:calc(100% - 20px);
}
#musicSearch::placeholder { color:#334455; }
#musicResults { flex:1; overflow-y:auto; padding:0 6px 6px; }
.music-result {
  display:flex; align-items:center; gap:9px; padding:8px 10px; border-radius:4px; cursor:pointer; transition:background .2s;
}
.music-result:hover { background:rgba(0,207,255,.08); }
.music-result.playing { background:rgba(0,207,255,.12); border-left:2px solid var(--b); }
.result-num { font-size:.58rem; color:#334455; width:14px; text-align:center; flex-shrink:0; }
.result-info { flex:1; overflow:hidden; }
.result-title { font-size:.66rem; color:#c0d8ff; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.result-artist { font-size:.58rem; color:#446688; }
.result-dur { font-size:.58rem; color:#446688; flex-shrink:0; }

#musicMain { flex:1; display:flex; flex-direction:column; align-items:center; justify-content:space-between; padding:30px 30px 0; overflow:hidden; }

.now-playing-art {
  width:190px; height:190px; border-radius:8px; background:linear-gradient(135deg,#0a1020,#060b18);
  display:flex; align-items:center; justify-content:center; font-size:4rem;
  border:1px solid rgba(0,207,255,.2); box-shadow:0 0 50px rgba(0,207,255,.1),0 20px 50px rgba(0,0,0,.5);
  position:relative; overflow:hidden; flex-shrink:0;
}
.now-playing-art::before {
  content:''; position:absolute; inset:-100%;
  background:conic-gradient(from 0deg,transparent,rgba(0,207,255,.08),transparent,rgba(0,255,136,.05),transparent);
  animation:spinart 10s linear infinite;
}
@keyframes spinart{to{transform:rotate(360deg)}}
#nowArtwork { position:relative; z-index:1; }

.now-track-info { text-align:center; padding:16px 0; flex-shrink:0; }
.now-title { font-family:'Orbitron',sans-serif; font-size:.95rem; color:#fff; letter-spacing:2px; margin-bottom:5px; }
.now-artist { font-size:.72rem; color:#6688aa; letter-spacing:2px; }

#lyricsPanel { flex:1; overflow-y:auto; width:100%; max-width:480px; padding:0 0 16px; text-align:center; }
.lyric-placeholder { color:#334455; font-size:.72rem; letter-spacing:2px; margin-top:16px; }

#musicPlayer { width:100%; background:rgba(8,12,26,.95); border-top:1px solid rgba(0,207,255,.12); padding:14px 30px; flex-shrink:0; position:relative; }
.progress-wrap { display:flex; align-items:center; gap:10px; margin-bottom:10px; }
#progressBar { flex:1; height:4px; background:rgba(0,207,255,.15); border-radius:2px; cursor:pointer; }
#progressFill { height:100%; background:linear-gradient(to right,var(--g),var(--b)); border-radius:2px; width:0%; transition:width .5s linear; position:relative; }
#progressFill::after { content:''; position:absolute; right:-5px; top:-4px; width:11px; height:11px; background:var(--b); border-radius:50%; box-shadow:0 0 7px var(--b); }
.time-label { font-size:.58rem; color:#446688; width:34px; text-align:center; }
.waveform { display:flex; gap:3px; align-items:flex-end; height:20px; margin-left:10px; }
.wave-bar { width:3px; background:var(--b); border-radius:2px; animation:wv .7s ease-in-out infinite alternate; box-shadow:0 0 4px var(--b); }
.wave-bar:nth-child(1){animation-delay:0s;height:8px}.wave-bar:nth-child(2){animation-delay:.1s;height:14px}.wave-bar:nth-child(3){animation-delay:.2s;height:20px}.wave-bar:nth-child(4){animation-delay:.15s;height:12px}.wave-bar:nth-child(5){animation-delay:.05s;height:17px}.wave-bar:nth-child(6){animation-delay:.25s;height:8px}
@keyframes wv{from{transform:scaleY(.2)}to{transform:scaleY(1)}}
.waveform.paused .wave-bar{animation-play-state:paused}
.music-controls-row { display:flex; align-items:center; justify-content:center; gap:14px; }
.mc-btn { background:none; border:none; color:#446688; font-size:1.1rem; cursor:pointer; padding:6px; transition:color .2s,transform .1s; line-height:1; }
.mc-btn:hover { color:var(--b); transform:scale(1.15); }
.mc-btn.play { background:var(--b); color:#050810; width:42px; height:42px; border-radius:50%; font-size:.95rem; display:flex; align-items:center; justify-content:center; box-shadow:0 0 18px rgba(0,207,255,.4); }
.mc-btn.play:hover { transform:scale(1.08); color:#050810; opacity:.9; }
.vol-row { display:flex; align-items:center; gap:7px; position:absolute; right:30px; bottom:20px; }
.vol-row span { font-size:.63rem; color:#334455; }
input[type=range].vol { -webkit-appearance:none; width:65px; height:3px; background:rgba(0,207,255,.2); border-radius:2px; outline:none; }
input[type=range].vol::-webkit-slider-thumb { -webkit-appearance:none; width:10px; height:10px; background:var(--b); border-radius:50%; box-shadow:0 0 5px var(--b); cursor:pointer; }

/* â”€â”€ AI â”€â”€ */
#page-ai { flex-direction:row; }
.ai-sidebar { width:190px; background:rgba(12,18,32,.8); border-right:1px solid rgba(255,0,170,.1); padding:14px 8px; display:flex; flex-direction:column; gap:4px; flex-shrink:0; }
.ai-tool-btn { display:flex; align-items:center; gap:9px; background:none; border:none; color:#556677; font-family:'Share Tech Mono',monospace; font-size:.63rem; letter-spacing:1px; padding:9px 10px; border-radius:3px; cursor:pointer; text-align:left; transition:all .2s; }
.ai-tool-btn:hover { color:var(--p); background:rgba(255,0,170,.06); }
.ai-tool-btn.active { color:var(--p); background:rgba(255,0,170,.1); border-left:2px solid var(--p); }
#aiMain { flex:1; display:flex; flex-direction:column; overflow:hidden; }
.ai-tool-content { display:none; flex:1; flex-direction:column; overflow:hidden; }
.ai-tool-content.active { display:flex; }

#chatMessages { flex:1; overflow-y:auto; padding:18px; display:flex; flex-direction:column; gap:13px; }
.msg { display:flex; gap:11px; animation:fadeUp .3s ease; }
@keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.msg.user { flex-direction:row-reverse; }
.msg-avatar { width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:.85rem; flex-shrink:0; }
.msg.ai .msg-avatar { background:rgba(255,0,170,.15); border:1px solid rgba(255,0,170,.3); }
.msg.user .msg-avatar { background:rgba(0,255,136,.15); border:1px solid rgba(0,255,136,.3); }
.msg-bubble { max-width:70%; padding:11px 14px; border-radius:6px; font-size:.73rem; line-height:1.7; letter-spacing:.4px; }
.msg.ai .msg-bubble { background:rgba(255,0,170,.06); border:1px solid rgba(255,0,170,.12); color:#c0c8dd; }
.msg.user .msg-bubble { background:rgba(0,255,136,.06); border:1px solid rgba(0,255,136,.12); color:#c0ddc0; text-align:right; }

.chat-input-row { display:flex; padding:14px; border-top:1px solid rgba(255,0,170,.1); }
.chat-input-row input { flex:1; background:rgba(255,0,170,.04); border:1px solid rgba(255,0,170,.18); border-right:none; border-radius:3px 0 0 3px; color:#c0d8ff; font-family:'Share Tech Mono',monospace; font-size:.73rem; padding:11px 14px; outline:none; letter-spacing:1px; }
.chat-input-row button { background:var(--p); border:none; color:#fff; padding:11px 18px; font-family:'Orbitron',monospace; font-size:.63rem; font-weight:700; letter-spacing:2px; border-radius:0 3px 3px 0; cursor:pointer; }

.imggen-wrap { flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:18px; padding:30px; }
.imggen-wrap h2 { font-family:'Orbitron',sans-serif; font-size:.95rem; color:var(--p); letter-spacing:3px; }
.imggen-input-row { display:flex; width:100%; max-width:560px; }
.imggen-input-row input { flex:1; background:rgba(255,0,170,.04); border:1px solid rgba(255,0,170,.2); border-right:none; border-radius:3px 0 0 3px; color:#c0d8ff; font-family:'Share Tech Mono',monospace; font-size:.73rem; padding:11px 14px; outline:none; }
.imggen-input-row button { background:var(--p); border:none; color:#fff; padding:11px 18px; font-family:'Orbitron',monospace; font-size:.63rem; font-weight:700; letter-spacing:2px; border-radius:0 3px 3px 0; cursor:pointer; }
#imgOutput { width:100%; max-width:380px; aspect-ratio:1; background:rgba(255,0,170,.04); border:1px dashed rgba(255,0,170,.2); border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:.73rem; color:#446688; text-align:center; flex-direction:column; gap:8px; overflow:hidden; }
#imgOutput img { width:100%; height:100%; object-fit:cover; border-radius:8px; }

/* â”€â”€ APPS â”€â”€ */
#page-apps { flex-direction:column; overflow-y:auto; }
.apps-header { padding:24px 26px 16px; font-family:'Orbitron',sans-serif; font-size:.68rem; color:#446688; letter-spacing:4px; border-bottom:1px solid var(--border); display:flex; align-items:center; gap:14px; }
.apps-header::after { content:''; flex:1; height:1px; background:linear-gradient(to right,var(--border),transparent); }
.apps-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(170px,1fr)); gap:14px; padding:20px 26px; }
.app-card { background:var(--card2); border:1px solid rgba(0,207,255,.08); border-radius:8px; padding:18px 14px; cursor:pointer; transition:all .2s; display:flex; flex-direction:column; gap:9px; text-decoration:none; }
.app-card:hover { border-color:var(--b); box-shadow:0 4px 18px rgba(0,207,255,.12); transform:translateY(-2px); }
.app-card.featured { border-color:rgba(255,204,0,.3); background:rgba(255,204,0,.04); box-shadow:0 0 20px rgba(255,204,0,.08); }
.app-card.featured:hover { border-color:var(--y); box-shadow:0 4px 24px rgba(255,204,0,.2); }
.app-icon { font-size:1.8rem; }
.app-name { font-family:'Orbitron',sans-serif; font-size:.63rem; color:#c0d8ff; letter-spacing:1px; }
.app-desc { font-size:.58rem; color:#446688; line-height:1.6; }
.app-tag { display:inline-block; font-size:.53rem; letter-spacing:2px; padding:3px 7px; border-radius:2px; margin-top:auto; }
.app-tag.free { background:rgba(0,255,136,.1); color:var(--g); border:1px solid rgba(0,255,136,.2); }
.app-tag.proxy { background:rgba(0,207,255,.1); color:var(--b); border:1px solid rgba(0,207,255,.2); }
.app-tag.unblock { background:rgba(255,204,0,.12); color:var(--y); border:1px solid rgba(255,204,0,.3); }
.app-tag.blocked { background:rgba(0,207,255,.08); color:var(--b); border:1px solid rgba(0,207,255,.2); }

/* â”€â”€ GAMES built-in â”€â”€ */
#page-builtin { flex-direction:column; overflow:hidden; }
#builtinFrame { flex:1; border:none; width:100%; }

/* scrollbars */
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:rgba(0,255,136,.2);border-radius:3px}

.spinner { width:18px; height:18px; border:2px solid rgba(0,207,255,.2); border-top-color:var(--b); border-radius:50%; animation:cspin .8s linear infinite; display:inline-block; }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     COVER SCREEN
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="cover">
  <div class="cover-spinner"></div>
  <div class="cover-text">Loading resources...</div>
  <!-- invisible input captures keystrokes -->
  <input id="coverPass" type="password" autocomplete="off">
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN APP
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="app">

  <!-- TOPBAR -->
  <div id="topbar">
    <div class="logo">NEXUS<span>.</span>GG</div>
    <div id="navtabs">
      <button class="navtab active" onclick="switchPage('games',this)">ğŸ® GAMES</button>
      <button class="navtab" onclick="switchPage('music',this)">ğŸµ MUSIC</button>
      <button class="navtab" onclick="switchPage('ai',this)">ğŸ¤– AI</button>
      <button class="navtab" onclick="switchPage('apps',this)">ğŸ“± APPS</button>
      <button class="navtab" onclick="switchPage('settings',this)">âš™ï¸ SETTINGS</button>
    </div>
    <div class="badge-online">ğŸŸ¢ UNLOCKED</div>
  </div>

  <!-- MAIN -->
  <div id="main">

    <!-- GAMES -->
    <div class="page active" id="page-games">
      <div id="gamesMain">
        <div class="games-back" id="gamesBack">
          <button onclick="closeGameFrame()">â† BACK</button>
          <span id="currentGameName"></span>
        </div>
        <div id="searchBar">
          <input id="gameSearch" type="text" placeholder="Search games..." oninput="filterGames(this.value)">
        </div>
        <div id="gamesContent">
          <div class="games-grid" id="gamesGrid"></div>
        </div>
        <iframe id="gamesFrame" allowfullscreen sandbox="allow-scripts allow-same-origin allow-forms allow-pointer-lock allow-popups"></iframe>
      </div>
      <div id="gamesSidebar">
        <button class="cat-pill active" onclick="setGameCat(this,'all')">ALL</button>
        <button class="cat-pill" onclick="setGameCat(this,'action')">âš¡ ACTION</button>
        <button class="cat-pill" onclick="setGameCat(this,'puzzle')">ğŸ§© PUZZLE</button>
        <button class="cat-pill" onclick="setGameCat(this,'racing')">ğŸï¸ RACING</button>
        <button class="cat-pill" onclick="setGameCat(this,'shooter')">ğŸ”« SHOOTER</button>
        <button class="cat-pill" onclick="setGameCat(this,'sports')">âš½ SPORTS</button>
        <button class="cat-pill" onclick="setGameCat(this,'io')">ğŸŒ .IO</button>
        <button class="cat-pill" onclick="setGameCat(this,'classic')">ğŸ‘¾ CLASSIC</button>
      </div>
    </div>

    <!-- MUSIC -->
    <div class="page" id="page-music">
      <div id="musicSidebar">
        <div class="music-sidebar-header">â™¬ SEARCH MUSIC</div>
        <input id="musicSearch" type="text" placeholder="Search songs..." onkeydown="if(event.key==='Enter')searchMusic()">
        <div id="musicResults">
          <div style="padding:18px 10px;font-size:.63rem;color:#334455;letter-spacing:1px;">Search for a track to play...</div>
        </div>
      </div>
      <div id="musicMain">
        <div class="now-playing-art"><span id="nowArtwork">ğŸµ</span></div>
        <div class="now-track-info">
          <div class="now-title" id="nowTitle">NOT PLAYING</div>
          <div class="now-artist" id="nowArtist">Search a song on the left</div>
        </div>
        <div id="lyricsPanel">
          <div class="lyric-placeholder">Play a song to see info</div>
        </div>
        <div id="musicPlayer" style="position:relative;">
          <div class="progress-wrap">
            <span class="time-label" id="timeCur">0:00</span>
            <div id="progressBar" onclick="seekAudio(event)"><div id="progressFill"></div></div>
            <span class="time-label" id="timeTot">0:00</span>
            <div class="waveform" id="waveformEl">
              <div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div>
              <div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div>
            </div>
          </div>
          <div class="music-controls-row">
            <button class="mc-btn" onclick="shuffleTrack()">ğŸ”€</button>
            <button class="mc-btn" onclick="prevTrack()">â®</button>
            <button class="mc-btn play" id="playPauseBtn" onclick="toggleMusicPlay()">â–¶</button>
            <button class="mc-btn" onclick="nextTrack()">â­</button>
            <button class="mc-btn" onclick="toggleRepeat()" id="repeatBtn">ğŸ”</button>
          </div>
          <div class="vol-row">
            <span>ğŸ”ˆ</span>
            <input type="range" class="vol" min="0" max="100" value="80" oninput="setMusicVol(this.value)">
            <span>ğŸ”Š</span>
          </div>
        </div>
      </div>
    </div>

    <!-- AI -->
    <div class="page" id="page-ai">
      <div class="ai-sidebar">
        <button class="ai-tool-btn active" onclick="setAITool('chat',this)">ğŸ’¬ AI CHAT</button>
        <button class="ai-tool-btn" onclick="setAITool('imggen',this)">ğŸ¨ IMAGE GEN</button>
        <button class="ai-tool-btn" onclick="setAITool('translate',this)">ğŸŒ TRANSLATE</button>
        <button class="ai-tool-btn" onclick="setAITool('summarize',this)">ğŸ“ SUMMARIZE</button>
      </div>
      <div id="aiMain">
        <!-- CHAT -->
        <div class="ai-tool-content active" id="aitool-chat">
          <div id="chatMessages"></div>
          <div class="chat-input-row">
            <input id="chatInput" type="text" placeholder="Ask the AI anything..." onkeydown="if(event.key==='Enter')sendChat()">
            <button onclick="sendChat()">SEND</button>
          </div>
        </div>
        <!-- IMAGE GEN -->
        <div class="ai-tool-content" id="aitool-imggen">
          <div class="imggen-wrap">
            <h2>ğŸ¨ AI IMAGE GENERATOR</h2>
            <p style="font-size:.7rem;color:#446688;letter-spacing:1px;">Describe an image and AI will generate it</p>
            <div class="imggen-input-row">
              <input id="imgPrompt" type="text" placeholder="A neon cyberpunk city at night..." onkeydown="if(event.key==='Enter')generateImage()">
              <button onclick="generateImage()">GENERATE</button>
            </div>
            <div id="imgOutput">
              <span style="font-size:2rem;">ğŸ–¼ï¸</span>
              <span>Your image will appear here</span>
            </div>
          </div>
        </div>
        <!-- TRANSLATE -->
        <div class="ai-tool-content" id="aitool-translate">
          <div style="flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:14px;padding:30px;">
            <h2 style="font-family:'Orbitron',sans-serif;font-size:.95rem;color:var(--p);letter-spacing:3px;">ğŸŒ TRANSLATOR</h2>
            <div style="display:flex;gap:10px;width:100%;max-width:680px;">
              <div style="flex:1;display:flex;flex-direction:column;gap:7px;">
                <select id="fromLang" style="background:rgba(255,0,170,.04);border:1px solid rgba(255,0,170,.2);color:var(--p);font-family:'Share Tech Mono',monospace;font-size:.63rem;padding:6px 10px;border-radius:3px;outline:none;">
                  <option value="auto">Auto Detect</option><option value="en">English</option><option value="es">Spanish</option>
                  <option value="fr">French</option><option value="de">German</option><option value="ja">Japanese</option>
                  <option value="zh">Chinese</option><option value="ar">Arabic</option><option value="pt">Portuguese</option>
                </select>
                <textarea id="translateIn" rows="8" placeholder="Enter text to translate..." style="flex:1;background:rgba(255,0,170,.04);border:1px solid rgba(255,0,170,.15);border-radius:4px;color:#c0d8ff;font-family:'Share Tech Mono',monospace;font-size:.73rem;padding:11px;outline:none;resize:none;line-height:1.7;width:100%;"></textarea>
              </div>
              <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;">
                <button onclick="doTranslate()" style="background:var(--p);border:none;color:#fff;padding:11px 14px;font-family:'Orbitron',monospace;font-size:.58rem;font-weight:700;letter-spacing:2px;border-radius:3px;cursor:pointer;">â†’</button>
              </div>
              <div style="flex:1;display:flex;flex-direction:column;gap:7px;">
                <select id="toLang" style="background:rgba(255,0,170,.04);border:1px solid rgba(255,0,170,.2);color:var(--p);font-family:'Share Tech Mono',monospace;font-size:.63rem;padding:6px 10px;border-radius:3px;outline:none;">
                  <option value="es">Spanish</option><option value="en">English</option><option value="fr">French</option>
                  <option value="de">German</option><option value="ja">Japanese</option><option value="zh">Chinese</option>
                  <option value="ar">Arabic</option><option value="pt">Portuguese</option>
                </select>
                <textarea id="translateOut" rows="8" readonly placeholder="Translation..." style="flex:1;background:rgba(0,0,0,.3);border:1px solid rgba(255,0,170,.1);border-radius:4px;color:var(--g);font-family:'Share Tech Mono',monospace;font-size:.73rem;padding:11px;outline:none;resize:none;line-height:1.7;width:100%;"></textarea>
              </div>
            </div>
          </div>
        </div>
        <!-- SUMMARIZE -->
        <div class="ai-tool-content" id="aitool-summarize">
          <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:14px;padding:30px;">
            <h2 style="font-family:'Orbitron',sans-serif;font-size:.95rem;color:var(--p);letter-spacing:3px;">ğŸ“ SUMMARIZER</h2>
            <textarea id="summarizeIn" rows="8" placeholder="Paste any long text here..." style="width:100%;max-width:680px;background:rgba(255,0,170,.04);border:1px solid rgba(255,0,170,.15);border-radius:4px;color:#c0d8ff;font-family:'Share Tech Mono',monospace;font-size:.73rem;padding:12px;outline:none;resize:none;line-height:1.7;"></textarea>
            <button onclick="doSummarize()" style="background:var(--p);border:none;color:#fff;padding:11px 26px;font-family:'Orbitron',monospace;font-size:.68rem;font-weight:700;letter-spacing:3px;border-radius:3px;cursor:pointer;">SUMMARIZE</button>
            <div id="summarizeOut" style="width:100%;max-width:680px;background:rgba(0,0,0,.3);border:1px solid rgba(0,255,136,.1);border-radius:4px;color:var(--g);font-family:'Share Tech Mono',monospace;font-size:.73rem;padding:12px;line-height:1.8;min-height:70px;"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- APPS -->
    <div class="page" id="page-apps">
      <div id="appsListView" style="display:flex;flex-direction:column;overflow-y:auto;">
        <div class="apps-header">UNBLOCKED APPS</div>
        <div class="apps-grid" id="appsGrid"></div>
      </div>
      <div id="appViewer" style="display:none;flex:1;flex-direction:column;overflow:hidden;">
        <div style="display:flex;align-items:center;gap:12px;padding:10px 16px;background:rgba(0,0,0,.7);border-bottom:1px solid var(--border);flex-shrink:0;">
          <button onclick="closeAppViewer()" style="background:none;border:1px solid rgba(255,0,170,.3);color:var(--p);padding:5px 14px;font-family:'Share Tech Mono',monospace;font-size:.65rem;letter-spacing:2px;border-radius:2px;cursor:pointer;">â† BACK</button>
          <span id="appViewerName" style="font-family:'Orbitron',sans-serif;font-size:.7rem;color:#c0d8ff;letter-spacing:2px;flex:1;"></span>
          <button onclick="openCurrentAppNewTab()" style="background:none;border:1px solid rgba(0,207,255,.3);color:var(--b);padding:5px 14px;font-family:'Share Tech Mono',monospace;font-size:.65rem;letter-spacing:2px;border-radius:2px;cursor:pointer;">â†— NEW TAB</button>
        </div>
        <div id="appBlockedMsg" style="display:none;align-items:center;justify-content:center;flex-direction:column;gap:16px;padding:40px;text-align:center;flex:1;">
          <div style="font-size:3rem;">ğŸš«</div>
          <div style="font-family:'Orbitron',sans-serif;font-size:.9rem;color:var(--p);letter-spacing:3px;">BLOCKED IN FRAME</div>
          <div style="font-size:.73rem;color:#556677;letter-spacing:1px;max-width:420px;line-height:1.8;">All proxy methods failed for this site. It's heavily blocking iframes. Try opening in a new tab.</div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;">
            <button onclick="proxyIndex=0;showAppBlocked();document.getElementById('appBlockedMsg').style.display='none';document.getElementById('appFrame').style.display='block';loadInFrame(currentAppUrl);" style="background:rgba(0,255,136,.1);border:1px solid var(--g);color:var(--g);padding:10px 20px;font-family:'Orbitron',monospace;font-size:.63rem;font-weight:700;letter-spacing:2px;border-radius:3px;cursor:pointer;">ğŸ”„ RETRY</button>
            <button onclick="openCurrentAppNewTab()" style="background:var(--b);border:none;color:#050810;padding:10px 20px;font-family:'Orbitron',monospace;font-size:.63rem;font-weight:700;letter-spacing:3px;border-radius:3px;cursor:pointer;">â†— NEW TAB</button>
          </div>
        </div>
        <iframe id="appFrame" style="flex:1;border:none;width:100%;background:#000;" allow="fullscreen *; autoplay *; clipboard-write *"></iframe>
      </div>
    </div>

    <!-- SETTINGS -->
    <div class="page" id="page-settings">
      <div style="overflow-y:auto;flex:1;padding:30px 40px;display:flex;flex-direction:column;gap:28px;max-width:700px;">

        <div style="font-family:'Orbitron',sans-serif;font-size:1rem;color:var(--g);letter-spacing:4px;text-shadow:0 0 20px var(--g);">âš™ï¸ SETTINGS</div>

        <!-- UNBLOCKER URL -->
        <div style="background:var(--card2);border:1px solid rgba(255,204,0,.2);border-radius:8px;padding:20px;">
          <div style="font-family:'Orbitron',sans-serif;font-size:.68rem;color:var(--y);letter-spacing:3px;margin-bottom:6px;">ğŸ”“ UNBLOCKER URL</div>
          <div style="font-size:.65rem;color:#446688;letter-spacing:1px;margin-bottom:12px;">Change the unblocker link â€” password required so only you can change it</div>
          <div style="display:flex;flex-direction:column;gap:8px;">
            <input id="settingUnblocker" type="text" value="https://learn.szczech.com.ar/" style="background:rgba(255,204,0,.04);border:1px solid rgba(255,204,0,.2);border-radius:3px;color:var(--y);font-family:'Share Tech Mono',monospace;font-size:.7rem;padding:10px 14px;outline:none;letter-spacing:1px;width:100%;" placeholder="New unblocker URL...">
            <div style="display:flex;gap:0;">
              <input id="unblockerPassInput" type="password" placeholder="Enter your password to save..." style="flex:1;background:rgba(255,204,0,.04);border:1px solid rgba(255,204,0,.2);border-right:none;border-radius:3px 0 0 3px;color:var(--y);font-family:'Share Tech Mono',monospace;font-size:.7rem;padding:10px 14px;outline:none;letter-spacing:2px;" onkeydown="if(event.key==='Enter')saveUnblocker()">
              <button onclick="saveUnblocker()" style="background:var(--y);border:none;color:#050810;padding:10px 18px;font-family:'Orbitron',monospace;font-size:.63rem;font-weight:700;letter-spacing:2px;border-radius:0 3px 3px 0;cursor:pointer;">SAVE</button>
            </div>
          </div>
          <div id="unblockerSaved" style="display:none;font-size:.63rem;color:var(--g);margin-top:8px;letter-spacing:1px;">âœ… Unblocker URL saved!</div>
          <div id="unblockerError" style="display:none;font-size:.63rem;color:var(--p);margin-top:8px;letter-spacing:1px;">âŒ Wrong password â€” only the owner can change this</div>
        </div>

        <!-- PASSWORD -->
        <div style="background:var(--card2);border:1px solid rgba(0,255,136,.15);border-radius:8px;padding:20px;">
          <div style="font-family:'Orbitron',sans-serif;font-size:.68rem;color:var(--g);letter-spacing:3px;margin-bottom:6px;">ğŸ”’ CHANGE PASSWORD</div>
          <div style="font-size:.65rem;color:#446688;letter-spacing:1px;margin-bottom:12px;">Change the password for the loading screen</div>
          <div style="display:flex;flex-direction:column;gap:8px;">
            <input id="settingPassOld" type="password" placeholder="Current password" style="background:rgba(0,255,136,.04);border:1px solid rgba(0,255,136,.15);border-radius:3px;color:var(--g);font-family:'Share Tech Mono',monospace;font-size:.7rem;padding:10px 14px;outline:none;letter-spacing:2px;">
            <input id="settingPassNew" type="password" placeholder="New password" style="background:rgba(0,255,136,.04);border:1px solid rgba(0,255,136,.15);border-radius:3px;color:var(--g);font-family:'Share Tech Mono',monospace;font-size:.7rem;padding:10px 14px;outline:none;letter-spacing:2px;">
            <button onclick="savePassword()" style="background:var(--g);border:none;color:#050810;padding:10px 18px;font-family:'Orbitron',monospace;font-size:.63rem;font-weight:700;letter-spacing:2px;border-radius:3px;cursor:pointer;width:fit-content;">SAVE PASSWORD</button>
          </div>
          <div id="passSaved" style="display:none;font-size:.63rem;color:var(--g);margin-top:8px;letter-spacing:1px;">âœ… Password changed!</div>
          <div id="passError" style="display:none;font-size:.63rem;color:var(--p);margin-top:8px;letter-spacing:1px;">âŒ Wrong current password</div>
        </div>

        <!-- THEME -->
        <div style="background:var(--card2);border:1px solid rgba(0,207,255,.15);border-radius:8px;padding:20px;">
          <div style="font-family:'Orbitron',sans-serif;font-size:.68rem;color:var(--b);letter-spacing:3px;margin-bottom:6px;">ğŸ¨ THEME COLOR</div>
          <div style="font-size:.65rem;color:#446688;letter-spacing:1px;margin-bottom:14px;">Pick your accent color</div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;">
            <div class="theme-btn" onclick="setTheme('#00ff88','#00cfff')" style="background:linear-gradient(135deg,#00ff88,#00cfff);width:44px;height:44px;border-radius:50%;cursor:pointer;border:2px solid #fff;box-shadow:0 0 12px #00ff88;" title="Green/Blue"></div>
            <div class="theme-btn" onclick="setTheme('#ff00aa','#ff6600')" style="background:linear-gradient(135deg,#ff00aa,#ff6600);width:44px;height:44px;border-radius:50%;cursor:pointer;border:2px solid transparent;" title="Pink/Orange"></div>
            <div class="theme-btn" onclick="setTheme('#a855f7','#ec4899')" style="background:linear-gradient(135deg,#a855f7,#ec4899);width:44px;height:44px;border-radius:50%;cursor:pointer;border:2px solid transparent;" title="Purple/Pink"></div>
            <div class="theme-btn" onclick="setTheme('#f59e0b','#ef4444')" style="background:linear-gradient(135deg,#f59e0b,#ef4444);width:44px;height:44px;border-radius:50%;cursor:pointer;border:2px solid transparent;" title="Amber/Red"></div>
            <div class="theme-btn" onclick="setTheme('#06b6d4','#3b82f6')" style="background:linear-gradient(135deg,#06b6d4,#3b82f6);width:44px;height:44px;border-radius:50%;cursor:pointer;border:2px solid transparent;" title="Cyan/Blue"></div>
            <div class="theme-btn" onclick="setTheme('#10b981','#14b8a6')" style="background:linear-gradient(135deg,#10b981,#14b8a6);width:44px;height:44px;border-radius:50%;cursor:pointer;border:2px solid transparent;" title="Emerald/Teal"></div>
          </div>
          <div id="themeSaved" style="display:none;font-size:.63rem;color:var(--g);margin-top:10px;letter-spacing:1px;">âœ… Theme applied!</div>
        </div>

        <!-- COVER SCREEN -->
        <div style="background:var(--card2);border:1px solid rgba(255,0,170,.15);border-radius:8px;padding:20px;">
          <div style="font-family:'Orbitron',sans-serif;font-size:.68rem;color:var(--p);letter-spacing:3px;margin-bottom:6px;">ğŸ­ COVER SCREEN</div>
          <div style="font-size:.65rem;color:#446688;letter-spacing:1px;margin-bottom:14px;">Choose what the page looks like before the password is entered</div>
          <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button onclick="setCover('loading')" class="cover-opt active-cover" id="cover-loading" style="background:rgba(255,0,170,.08);border:1px solid rgba(255,0,170,.3);color:var(--p);padding:8px 16px;font-family:'Share Tech Mono',monospace;font-size:.63rem;letter-spacing:1px;border-radius:3px;cursor:pointer;">â³ Loading Spinner</button>
            <button onclick="setCover('classroom')" class="cover-opt" id="cover-classroom" style="background:none;border:1px solid rgba(255,0,170,.15);color:#556677;padding:8px 16px;font-family:'Share Tech Mono',monospace;font-size:.63rem;letter-spacing:1px;border-radius:3px;cursor:pointer;">ğŸ“š Google Classroom</button>
            <button onclick="setCover('docs')" class="cover-opt" id="cover-docs" style="background:none;border:1px solid rgba(255,0,170,.15);color:#556677;padding:8px 16px;font-family:'Share Tech Mono',monospace;font-size:.63rem;letter-spacing:1px;border-radius:3px;cursor:pointer;">ğŸ“ Google Docs</button>
            <button onclick="setCover('blank')" class="cover-opt" id="cover-blank" style="background:none;border:1px solid rgba(255,0,170,.15);color:#556677;padding:8px 16px;font-family:'Share Tech Mono',monospace;font-size:.63rem;letter-spacing:1px;border-radius:3px;cursor:pointer;">â¬œ Blank White</button>
          </div>
        </div>

        <!-- ABOUT -->
        <div style="background:var(--card2);border:1px solid rgba(0,255,136,.08);border-radius:8px;padding:20px;">
          <div style="font-family:'Orbitron',sans-serif;font-size:.68rem;color:#446688;letter-spacing:3px;margin-bottom:10px;">â„¹ï¸ ABOUT</div>
          <div style="font-size:.65rem;color:#334455;letter-spacing:1px;line-height:2;">NEXUS.GG â€” Your school arcade<br>Password protected Â· Offline games Â· AI tools Â· Music player</div>
        </div>

      </div>
    </div>

  </div><!-- /main -->
</div><!-- /app -->

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PASSWORD / COVER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentPassword = 'Jesus247'; // will be overridden by settings
let typed = '';

// Keep focus on hidden input when on cover
document.getElementById('cover').addEventListener('click', () => {
  document.getElementById('coverPass').focus();
});

document.getElementById('coverPass').addEventListener('input', function() {
  typed = this.value;
  if (typed === currentPassword) unlock();
});

// Also listen to keydown on the whole cover for keyboards that bypass input
document.addEventListener('keydown', (e) => {
  if (!document.getElementById('cover').style.display !== 'none') return;
  document.getElementById('coverPass').focus();
});

function unlock() {
  document.getElementById('cover').style.display = 'none';
  document.getElementById('app').style.display = 'flex';
  renderGames(games);
  addMsg('chatMessages','ai','Hey! I\'m NEXUS AI ğŸ¤– Ask me anything â€” gaming tips, homework help, or just chat!');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAV
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchPage(id, btn) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.navtab').forEach(b => b.classList.remove('active'));
  document.getElementById('page-' + id).classList.add('active');
  btn.classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GAMES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const games = [
  // IO GAMES
  { name:'SLITHER.IO', emoji:'ğŸ', cat:'io', url:'https://slither.io', rating:'4.9', plays:'50M+' },
  { name:'AGAR.IO', emoji:'ğŸ”µ', cat:'io', url:'https://agar.io', rating:'4.8', plays:'30M+' },
  { name:'PAPER.IO 2', emoji:'ğŸ“„', cat:'io', url:'https://paper-io.com', rating:'4.7', plays:'20M+' },
  { name:'LORDZ.IO', emoji:'ğŸ‘‘', cat:'io', url:'https://www.lordz.io', rating:'4.5', plays:'5M+' },
  { name:'DIEP.IO', emoji:'ğŸ”«', cat:'io', url:'https://diep.io', rating:'4.6', plays:'12M+' },
  { name:'MOPE.IO', emoji:'ğŸ»', cat:'io', url:'https://mope.io', rating:'4.4', plays:'8M+' },
  { name:'ZOMBS ROYALE', emoji:'ğŸ§Ÿ', cat:'io', url:'https://zombsroyale.io', rating:'4.7', plays:'15M+' },
  { name:'SURVIV.IO', emoji:'ğŸª–', cat:'io', url:'https://surviv.io', rating:'4.8', plays:'20M+' },
  { name:'WORMATE.IO', emoji:'ğŸ­', cat:'io', url:'https://wormate.io', rating:'4.5', plays:'7M+' },
  { name:'WINGS.IO', emoji:'âœˆï¸', cat:'io', url:'https://wings.io', rating:'4.4', plays:'5M+' },
  // SHOOTER
  { name:'KRUNKER.IO', emoji:'ğŸ¯', cat:'shooter', url:'https://krunker.io', rating:'4.9', plays:'15M+' },
  { name:'SHELL SHOCKERS', emoji:'ğŸ¥š', cat:'shooter', url:'https://shellshock.io', rating:'4.8', plays:'10M+' },
  { name:'BULLET FORCE', emoji:'ğŸ”«', cat:'shooter', url:'https://www.crazygames.com/game/bullet-force-multiplayer', rating:'4.7', plays:'8M+' },
  { name:'COMBAT ONLINE', emoji:'ğŸ’¥', cat:'shooter', url:'https://www.crazygames.com/game/combat-online', rating:'4.5', plays:'4M+' },
  // RACING
  { name:'MOTO X3M', emoji:'ğŸï¸', cat:'racing', url:'https://www.motox3m.com', rating:'4.8', plays:'8M+' },
  { name:'DRIFT BOSS', emoji:'ğŸš—', cat:'racing', url:'https://driftboss.io', rating:'4.6', plays:'5M+' },
  { name:'ROAD FURY', emoji:'ğŸš™', cat:'racing', url:'https://www.crazygames.com/game/road-fury', rating:'4.5', plays:'3M+' },
  { name:'MOTO X3M WINTER', emoji:'â„ï¸', cat:'racing', url:'https://www.crazygames.com/game/moto-x3m-winter', rating:'4.7', plays:'4M+' },
  { name:'BURNOUT DRIFT', emoji:'ğŸ’¨', cat:'racing', url:'https://www.crazygames.com/game/burnout-drift', rating:'4.6', plays:'3M+' },
  // PUZZLE
  { name:'2048', emoji:'ğŸ§©', cat:'puzzle', url:'https://play2048.co', rating:'4.7', plays:'100M+' },
  { name:'UNBLOCK ME', emoji:'ğŸŸ§', cat:'puzzle', url:'https://www.crazygames.com/game/unblock-it', rating:'4.5', plays:'5M+' },
  { name:'CUT THE ROPE', emoji:'ğŸ¬', cat:'puzzle', url:'https://www.crazygames.com/game/cut-the-rope-remastered', rating:'4.8', plays:'10M+' },
  { name:'MAHJONG', emoji:'ğŸ€„', cat:'puzzle', url:'https://www.crazygames.com/game/mahjong-classic', rating:'4.6', plays:'8M+' },
  { name:'SUDOKU', emoji:'ğŸ”¢', cat:'puzzle', url:'https://sudoku.com', rating:'4.7', plays:'20M+' },
  // ACTION
  { name:'MINECRAFT CLASSIC', emoji:'â›ï¸', cat:'action', url:'https://classic.minecraft.net', rating:'4.9', plays:'50M+' },
  { name:'AMONG US ONLINE', emoji:'ğŸ”´', cat:'action', url:'https://www.crazygames.com/game/among-us-online-edition', rating:'4.7', plays:'20M+' },
  { name:'STICKMAN HOOK', emoji:'ğŸ•¸ï¸', cat:'action', url:'https://www.crazygames.com/game/stickman-hook', rating:'4.8', plays:'12M+' },
  { name:'VENGE.IO', emoji:'âš”ï¸', cat:'action', url:'https://venge.io', rating:'4.7', plays:'6M+' },
  { name:'TEMPLE RUN', emoji:'ğŸƒ', cat:'action', url:'https://poki.com/en/g/temple-run-2', rating:'4.8', plays:'40M+' },
  { name:'SUBWAY SURFERS', emoji:'ğŸ›¹', cat:'action', url:'https://poki.com/en/g/subway-surfers', rating:'4.9', plays:'80M+' },
  { name:'GEOMETRY DASH LITE', emoji:'ğŸ”·', cat:'action', url:'https://www.crazygames.com/game/geometry-dash-classic', rating:'4.8', plays:'15M+' },
  { name:'FNAF ONLINE', emoji:'ğŸ»', cat:'action', url:'https://www.crazygames.com/game/five-nights-at-freddys', rating:'4.7', plays:'8M+' },
  // CLASSIC
  { name:'TETRIS', emoji:'ğŸŸ¦', cat:'classic', url:'https://tetris.com/play-tetris', rating:'4.9', plays:'1B+' },
  { name:'PAC-MAN', emoji:'ğŸ‘¾', cat:'classic', url:'https://www.google.com/logos/2010/pacman10-i.html', rating:'4.9', plays:'1B+' },
  { name:'COOKIE CLICKER', emoji:'ğŸª', cat:'classic', url:'https://orteil.dashnet.org/cookieclicker/', rating:'4.6', plays:'10M+' },
  { name:'SNAKE', emoji:'ğŸ', cat:'classic', url:'https://www.google.com/fbx?fbx=snake_arcade', rating:'4.7', plays:'500M+' },
  { name:'DINOSAUR GAME', emoji:'ğŸ¦–', cat:'classic', url:'https://chromedino.com', rating:'4.8', plays:'200M+' },
  { name:'FLAPPY BIRD', emoji:'ğŸ¤', cat:'classic', url:'https://flappybird.io', rating:'4.5', plays:'100M+' },
  // SPORTS
  { name:'BASKETBALL STARS', emoji:'ğŸ€', cat:'sports', url:'https://www.miniclip.com/games/basketball-stars/en/', rating:'4.7', plays:'3M+' },
  { name:'SOCCER SKILLS', emoji:'âš½', cat:'sports', url:'https://www.crazygames.com/game/soccer-skills-world-cup', rating:'4.5', plays:'2M+' },
  { name:'PENALTY SHOOTERS', emoji:'ğŸ¥…', cat:'sports', url:'https://www.crazygames.com/game/penalty-shooters-2', rating:'4.6', plays:'5M+' },
  { name:'GOLF ORBIT', emoji:'â›³', cat:'sports', url:'https://www.crazygames.com/game/golf-orbit', rating:'4.4', plays:'2M+' },
  { name:'BOXING RANDOM', emoji:'ğŸ¥Š', cat:'sports', url:'https://www.crazygames.com/game/boxing-random', rating:'4.7', plays:'4M+' },
];

let activeGameCat = 'all';

function renderGames(list) {
  document.getElementById('gamesGrid').innerHTML = list.map(g => `
    <div class="game-card" onclick="openGame('${g.name}','${g.emoji}','${g.url}')">
      <div class="game-thumb">${g.emoji}</div>
      <div class="game-info">
        <div class="game-name">${g.name}</div>
        <div class="game-meta"><span class="game-rating">â˜… ${g.rating}</span><span>${g.plays}</span></div>
      </div>
    </div>`).join('');
}

function setGameCat(btn, cat) {
  document.querySelectorAll('.cat-pill').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  activeGameCat = cat;
  filterGames(document.getElementById('gameSearch').value);
}

function filterGames(q) {
  let list = activeGameCat === 'all' ? games : games.filter(g => g.cat === activeGameCat);
  if (q) list = list.filter(g => g.name.toLowerCase().includes(q.toLowerCase()));
  renderGames(list);
}

function openGame(name, emoji, url) {
  document.getElementById('currentGameName').textContent = emoji + ' ' + name;
  document.getElementById('gamesContent').style.display = 'none';
  document.getElementById('gamesBack').style.display = 'flex';
  document.getElementById('gamesFrame').style.display = 'block';
  document.getElementById('gamesFrame').src = url;
}

function closeGameFrame() {
  document.getElementById('gamesFrame').src = 'about:blank';
  document.getElementById('gamesFrame').style.display = 'none';
  document.getElementById('gamesContent').style.display = 'block';
  document.getElementById('gamesBack').style.display = 'none';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MUSIC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let audioEl = new Audio();
let musicPlaying = false;
let currentMusicIndex = -1;
let musicQueue = [];
let repeatMode = false;

async function searchMusic() {
  const q = document.getElementById('musicSearch').value.trim();
  if (!q) return;
  const res = document.getElementById('musicResults');
  res.innerHTML = '<div style="padding:16px 10px;display:flex;align-items:center;gap:10px;"><div class="spinner"></div><span style="font-size:.63rem;color:#446688;">Searching...</span></div>';
  try {
    const resp = await fetch('https://corsproxy.io/?' + encodeURIComponent('https://api.deezer.com/search?q=' + encodeURIComponent(q) + '&limit=25'));
    const data = await resp.json();
    musicQueue = data.data || [];
    if (!musicQueue.length) { res.innerHTML = '<div style="padding:16px 10px;font-size:.63rem;color:#446688;">No results.</div>'; return; }
    res.innerHTML = musicQueue.map((t,i) => `
      <div class="music-result" id="mr-${i}" onclick="playTrack(${i})">
        <div class="result-num">${i+1}</div>
        <div class="result-info">
          <div class="result-title">${t.title}</div>
          <div class="result-artist">${t.artist.name}</div>
        </div>
        <div class="result-dur">${fmtTime(t.duration)}</div>
      </div>`).join('');
  } catch(e) {
    res.innerHTML = '<div style="padding:16px 10px;font-size:.63rem;color:#556688;">Search failed. Try again.</div>';
  }
}

function playTrack(i) {
  if (i < 0 || i >= musicQueue.length) return;
  currentMusicIndex = i;
  const t = musicQueue[i];
  document.querySelectorAll('.music-result').forEach(el => el.classList.remove('playing'));
  const el = document.getElementById('mr-' + i);
  if (el) el.classList.add('playing');
  document.getElementById('nowTitle').textContent = t.title;
  document.getElementById('nowArtist').textContent = t.artist.name;
  document.getElementById('nowArtwork').textContent = 'ğŸµ';
  document.getElementById('lyricsPanel').innerHTML = `
    <div class="lyric-placeholder">â™¬ ${t.title}</div>
    <div class="lyric-placeholder" style="margin-top:6px;font-size:.6rem;">by ${t.artist.name}</div>
    <div class="lyric-placeholder" style="margin-top:16px;font-size:.58rem;color:#224433;">30s preview Â· Deezer</div>`;
  if (t.preview) {
    audioEl.src = t.preview;
    audioEl.play();
    musicPlaying = true;
    document.getElementById('playPauseBtn').textContent = 'â¸';
    document.getElementById('waveformEl').classList.remove('paused');
  }
}

audioEl.addEventListener('timeupdate', () => {
  if (!audioEl.duration) return;
  const pct = (audioEl.currentTime / audioEl.duration) * 100;
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('timeCur').textContent = fmtTime(Math.floor(audioEl.currentTime));
  document.getElementById('timeTot').textContent = fmtTime(Math.floor(audioEl.duration));
});
audioEl.addEventListener('ended', () => { if (repeatMode) { audioEl.play(); return; } nextTrack(); });

function seekAudio(e) { const b = document.getElementById('progressBar'); audioEl.currentTime = audioEl.duration * (e.offsetX / b.offsetWidth); }
function toggleMusicPlay() {
  if (musicPlaying) { audioEl.pause(); musicPlaying=false; document.getElementById('playPauseBtn').textContent='â–¶'; document.getElementById('waveformEl').classList.add('paused'); }
  else { audioEl.play(); musicPlaying=true; document.getElementById('playPauseBtn').textContent='â¸'; document.getElementById('waveformEl').classList.remove('paused'); }
}
function nextTrack() { if (musicQueue.length) playTrack((currentMusicIndex+1)%musicQueue.length); }
function prevTrack() { if (musicQueue.length) playTrack((currentMusicIndex-1+musicQueue.length)%musicQueue.length); }
function shuffleTrack() { if (musicQueue.length) playTrack(Math.floor(Math.random()*musicQueue.length)); }
function toggleRepeat() { repeatMode=!repeatMode; document.getElementById('repeatBtn').style.color=repeatMode?'var(--g)':''; }
function setMusicVol(v) { audioEl.volume=v/100; }
function fmtTime(s) { s=Math.floor(s)||0; return Math.floor(s/60)+':'+String(s%60).padStart(2,'0'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setAITool(id, btn) {
  document.querySelectorAll('.ai-tool-content').forEach(el=>el.classList.remove('active'));
  document.querySelectorAll('.ai-tool-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('aitool-'+id).classList.add('active');
  btn.classList.add('active');
}

function addMsg(container, role, text) {
  const d = document.createElement('div');
  d.className = 'msg ' + role;
  d.innerHTML = `<div class="msg-avatar">${role==='ai'?'ğŸ¤–':'ğŸ‘¤'}</div><div class="msg-bubble">${text}</div>`;
  document.getElementById(container).appendChild(d);
  document.getElementById(container).scrollTop = 99999;
  return d;
}

async function callClaude(prompt, system='') {
  const body = { model:'claude-sonnet-4-20250514', max_tokens:1000, messages:[{role:'user',content:prompt}] };
  if (system) body.system = system;
  const res = await fetch('https://api.anthropic.com/v1/messages', {
    method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(body)
  });
  const data = await res.json();
  return data.content?.map(c=>c.text||'').join('')||'No response.';
}

async function sendChat() {
  const inp = document.getElementById('chatInput');
  const msg = inp.value.trim(); if (!msg) return;
  inp.value = '';
  addMsg('chatMessages','user',msg);
  const waiting = addMsg('chatMessages','ai','<div class="spinner"></div>');
  try {
    const reply = await callClaude(msg,'You are NEXUS AI, a fun helpful assistant for a gaming site. Keep answers concise and cool.');
    waiting.querySelector('.msg-bubble').innerHTML = reply;
  } catch(e) { waiting.querySelector('.msg-bubble').innerHTML = 'Error. Try again.'; }
}

function generateImage() {
  const prompt = document.getElementById('imgPrompt').value.trim(); if (!prompt) return;
  const out = document.getElementById('imgOutput');
  out.innerHTML = '<div class="spinner"></div><span style="font-size:.7rem;color:#446688;margin-top:8px;">Generating...</span>';
  const url = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?width=512&height=512&nologo=true&seed=${Date.now()}`;
  const img = new Image();
  img.onload = () => { out.innerHTML=''; out.appendChild(img); };
  img.onerror = () => { out.innerHTML='<span style="color:#556677;">Failed. Try another prompt.</span>'; };
  img.src = url;
  img.style.cssText = 'width:100%;height:100%;object-fit:cover;border-radius:8px;';
}

async function doTranslate() {
  const text = document.getElementById('translateIn').value.trim(); if (!text) return;
  document.getElementById('translateOut').value = 'Translating...';
  try {
    const to = document.getElementById('toLang').value;
    const from = document.getElementById('fromLang').value;
    const reply = await callClaude(`Translate${from!=='auto'?' from '+from:''} to ${to}. Reply ONLY with the translation:\n\n${text}`);
    document.getElementById('translateOut').value = reply;
  } catch(e) { document.getElementById('translateOut').value = 'Failed.'; }
}

async function doSummarize() {
  const text = document.getElementById('summarizeIn').value.trim(); if (!text) return;
  document.getElementById('summarizeOut').textContent = 'Summarizing...';
  try {
    const reply = await callClaude('Summarize in 3-5 bullet points:\n\n' + text);
    document.getElementById('summarizeOut').textContent = reply;
  } catch(e) { document.getElementById('summarizeOut').textContent = 'Failed.'; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// APPS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const UNBLOCKER_URL = 'https://learn.szczech.com.ar/';

const apps = [
  {icon:'ğŸ”“',name:'UNBLOCKER',desc:'Equinox â€” YouTube, Discord, games & more',tag:'unblock',url:UNBLOCKER_URL,mode:'direct'},
  {icon:'ğŸ“º',name:'YOUTUBE',desc:'Watch videos & shorts',tag:'blocked',url:'https://www.youtube.com',mode:'routed'},
  {icon:'ğŸ’¬',name:'DISCORD',desc:'Chat with friends',tag:'blocked',url:'https://discord.com/app',mode:'routed'},
  {icon:'ğŸ®',name:'ROBLOX',desc:'Play Roblox online',tag:'blocked',url:'https://www.roblox.com',mode:'routed'},
  {icon:'ğŸµ',name:'SPOTIFY',desc:'Stream music',tag:'blocked',url:'https://open.spotify.com',mode:'routed'},
  {icon:'ğŸŸ ',name:'REDDIT',desc:'Browse communities',tag:'blocked',url:'https://www.reddit.com',mode:'routed'},
  {icon:'ğŸ¦',name:'TWITTER/X',desc:'Posts & trending news',tag:'blocked',url:'https://twitter.com',mode:'routed'},
  {icon:'ğŸ¬',name:'TWITCH',desc:'Live game streaming',tag:'blocked',url:'https://www.twitch.tv',mode:'routed'},
  {icon:'ğŸ“¸',name:'INSTAGRAM',desc:'Photos & reels',tag:'blocked',url:'https://www.instagram.com',mode:'routed'},
  {icon:'ğŸ¤–',name:'CHATGPT',desc:'OpenAI chatbot',tag:'blocked',url:'https://chat.openai.com',mode:'routed'},
  {icon:'ğŸµ',name:'TIKTOK',desc:'Short videos',tag:'blocked',url:'https://www.tiktok.com',mode:'routed'},
  {icon:'ğŸ‘»',name:'SNAPCHAT',desc:'Snaps & stories',tag:'blocked',url:'https://web.snapchat.com',mode:'routed'},
  {icon:'ğŸ®',name:'STEAM',desc:'PC gaming platform',tag:'blocked',url:'https://store.steampowered.com',mode:'routed'},
  {icon:'ğŸ¥',name:'NETFLIX',desc:'Stream movies & shows',tag:'blocked',url:'https://www.netflix.com',mode:'routed'},
  {icon:'ğŸ¥',name:'CINEBY',desc:'Free movies & shows',tag:'free',url:'https://www.cineby.gd',mode:'direct'},
  {icon:'ğŸ“½ï¸',name:'HEARTIVE',desc:'Movies, series & live TV',tag:'free',url:'https://heartiveloves.pages.dev',mode:'direct'},
  {icon:'ğŸ§®',name:'DESMOS',desc:'Graphing calculator',tag:'free',url:'https://www.desmos.com/calculator',mode:'direct'},
  {icon:'ğŸŒ',name:'WIKIPEDIA',desc:'All human knowledge',tag:'free',url:'https://en.m.wikipedia.org',mode:'direct'},
  {icon:'ğŸ“š',name:'KHAN ACADEMY',desc:'Free lessons & practice',tag:'free',url:'https://www.khanacademy.org',mode:'direct'},
  {icon:'ğŸ—ºï¸',name:'GOOGLE MAPS',desc:'Maps & directions',tag:'free',url:'https://maps.google.com/maps?output=embed',mode:'direct'},
  {icon:'ğŸ“–',name:'GUTENBERG',desc:'10,000+ free classic books',tag:'free',url:'https://www.gutenberg.org',mode:'direct'},
  {icon:'ğŸ®',name:'COOLMATHGAMES',desc:'Math & puzzle games',tag:'free',url:'https://www.coolmathgames.com',mode:'direct'},
  {icon:'ğŸ•¹ï¸',name:'POKI',desc:'100s of free browser games',tag:'free',url:'https://poki.com',mode:'direct'},
  {icon:'ğŸ“°',name:'GOOGLE SCHOLAR',desc:'Research & papers',tag:'free',url:'https://scholar.google.com',mode:'direct'},
  {icon:'ğŸŒ',name:'GOOGLE TRANSLATE',desc:'Translate any language',tag:'free',url:'https://translate.google.com',mode:'direct'},
  {icon:'ğŸ¨',name:'SKETCHPAD',desc:'Draw & create art online',tag:'free',url:'https://sketch.io/sketchpad/',mode:'direct'},
  {icon:'ğŸµ',name:'SOUNDCLOUD',desc:'Free music & podcasts',tag:'free',url:'https://soundcloud.com',mode:'direct'},
  {icon:'ğŸ“',name:'GOOGLE DOCS',desc:'Write & collaborate',tag:'free',url:'https://docs.google.com',mode:'direct'},
  {icon:'ğŸ“Š',name:'GOOGLE SLIDES',desc:'Make presentations',tag:'free',url:'https://slides.google.com',mode:'direct'},
  {icon:'ğŸ”¢',name:'GOOGLE SHEETS',desc:'Spreadsheets online',tag:'free',url:'https://sheets.google.com',mode:'direct'},
  {icon:'ğŸ”',name:'PERPLEXITY AI',desc:'AI-powered search',tag:'free',url:'https://www.perplexity.ai',mode:'direct'},
  {icon:'ğŸ’¡',name:'QUIZLET',desc:'Flashcards & study tools',tag:'free',url:'https://quizlet.com',mode:'direct'},
  {icon:'ğŸ§ ',name:'BRAINPOP',desc:'Educational videos & quizzes',tag:'free',url:'https://www.brainpop.com',mode:'direct'},
  {icon:'ğŸ¯',name:'GIMKIT',desc:'Fun learning games',tag:'free',url:'https://www.gimkit.com',mode:'direct'},
  {icon:'ğŸ•¹ï¸',name:'GAMEFLARE',desc:'Free HTML5 games',tag:'free',url:'https://gameflare.com',mode:'direct'},
];

let currentAppUrl = '';

// Proxy services that strip X-Frame-Options headers so sites load in iframes
const IFRAME_PROXIES = [
  url => `https://learn.szczech.com.ar/`,
  url => `https://corsproxy.io/?${encodeURIComponent(url)}`,
  url => `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`,
];
let proxyIndex = 0;

function openApp(url, name, mode) {
  currentAppUrl = url;
  document.getElementById('appsListView').style.display = 'none';
  document.getElementById('appViewer').style.display = 'flex';
  document.getElementById('appViewerName').textContent = name;
  document.getElementById('appBlockedMsg').style.display = 'none';
  const frame = document.getElementById('appFrame');
  frame.style.display = 'block';
  if (mode === 'routed') {
    // Open blocked sites via Equinox unblocker
    frame.src = UNBLOCKER_URL;
    // After Equinox loads, user can navigate to the site inside it
    // Show a helpful tip
    setTimeout(() => {
      document.getElementById('appViewerName').textContent = name + ' â€” search it inside Equinox â†‘';
    }, 1500);
  } else {
    // Load direct
    frame.src = url;
  }
}

function loadInFrame(url) {
  document.getElementById('appFrame').src = url;
}

function tryNextProxy() {
  showAppBlocked();
}

function showAppBlocked() {
  document.getElementById('appFrame').style.display = 'none';
  document.getElementById('appBlockedMsg').style.display = 'flex';
}

function closeAppViewer() {
  const frame = document.getElementById('appFrame');
  clearTimeout(frame._timer);
  frame.src = 'about:blank';
  document.getElementById('appViewer').style.display = 'none';
  document.getElementById('appsListView').style.display = 'flex';
  document.getElementById('appBlockedMsg').style.display = 'none';
  frame.style.display = 'block';
}

function openCurrentAppNewTab() {
  window.open(currentAppUrl, '_blank');
}

document.getElementById('appsGrid').innerHTML = apps.map(a=>`
  <div class="app-card${a.tag==='unblock'?' featured':''}" onclick="openApp('${a.url}','${a.icon} ${a.name}','${a.mode}')">
    <div class="app-icon">${a.icon}</div>
    <div class="app-name">${a.name}</div>
    <div class="app-desc">${a.desc}</div>
    <span class="app-tag ${a.tag}">${
      a.tag==='unblock'?'âš¡ UNBLOCKER':
      a.tag==='blocked'?'ğŸ”“ VIA PROXY':
      'âœ… FREE'
    }</span>
  </div>`).join('');

// Focus the hidden input immediately
window.addEventListener('load', () => {
  document.getElementById('coverPass').focus();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SETTINGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentCover = 'loading';

// Load saved settings
(function() {
  const savedPass = localStorage.getItem('nx_pass');
  if (savedPass) currentPassword = savedPass;
  const savedUnblocker = localStorage.getItem('nx_unblocker');
  if (savedUnblocker) {
    UNBLOCKER_URL = savedUnblocker;
    document.getElementById('settingUnblocker').value = savedUnblocker;
    // Update the app card
    const app = apps.find(a => a.tag === 'unblock');
    if (app) app.url = savedUnblocker;
  }
  const savedCover = localStorage.getItem('nx_cover');
  if (savedCover) { currentCover = savedCover; applyCoverStyle(savedCover); }
  const savedTheme = localStorage.getItem('nx_theme');
  if (savedTheme) {
    const [g, b] = JSON.parse(savedTheme);
    applyTheme(g, b);
  }
})();

function saveUnblocker() {
  const val = document.getElementById('settingUnblocker').value.trim();
  const pass = document.getElementById('unblockerPassInput').value;
  const okEl = document.getElementById('unblockerSaved');
  const errEl = document.getElementById('unblockerError');
  okEl.style.display = 'none';
  errEl.style.display = 'none';
  if (!val) return;
  if (pass !== currentPassword) {
    errEl.style.display = 'block';
    document.getElementById('unblockerPassInput').value = '';
    setTimeout(() => errEl.style.display = 'none', 3000);
    return;
  }
  UNBLOCKER_URL = val;
  localStorage.setItem('nx_unblocker', val);
  const app = apps.find(a => a.tag === 'unblock');
  if (app) app.url = val;
  document.getElementById('unblockerPassInput').value = '';
  okEl.style.display = 'block';
  setTimeout(() => okEl.style.display = 'none', 2000);
}

function savePassword() {
  const oldP = document.getElementById('settingPassOld').value;
  const newP = document.getElementById('settingPassNew').value.trim();
  const errEl = document.getElementById('passError');
  const okEl = document.getElementById('passSaved');
  errEl.style.display = 'none'; okEl.style.display = 'none';
  if (oldP !== currentPassword) { errEl.style.display = 'block'; return; }
  if (!newP) return;
  currentPassword = newP;
  localStorage.setItem('nx_pass', newP);
  okEl.style.display = 'block';
  document.getElementById('settingPassOld').value = '';
  document.getElementById('settingPassNew').value = '';
  setTimeout(() => okEl.style.display = 'none', 2000);
}

function setTheme(g, b) {
  applyTheme(g, b);
  localStorage.setItem('nx_theme', JSON.stringify([g, b]));
  const el = document.getElementById('themeSaved');
  el.style.display = 'block';
  setTimeout(() => el.style.display = 'none', 2000);
}

function applyTheme(g, b) {
  document.documentElement.style.setProperty('--g', g);
  document.documentElement.style.setProperty('--b', b);
}

function setCover(type) {
  currentCover = type;
  localStorage.setItem('nx_cover', type);
  document.querySelectorAll('.cover-opt').forEach(el => {
    el.style.background = 'none';
    el.style.borderColor = 'rgba(255,0,170,.15)';
    el.style.color = '#556677';
  });
  const active = document.getElementById('cover-' + type);
  if (active) {
    active.style.background = 'rgba(255,0,170,.08)';
    active.style.borderColor = 'rgba(255,0,170,.3)';
    active.style.color = 'var(--p)';
  }
}

function applyCoverStyle(type) {
  const cover = document.getElementById('cover');
  if (type === 'classroom') {
    cover.style.background = '#fff';
    cover.innerHTML = `
      <div style="width:100%;max-width:800px;padding:20px;">
        <div style="background:#1967d2;color:#fff;padding:16px 24px;border-radius:8px 8px 0 0;font-family:Arial,sans-serif;font-size:18px;font-weight:500;">Google Classroom</div>
        <div style="background:#f8f9fa;border:1px solid #e0e0e0;border-top:none;padding:40px 24px;border-radius:0 0 8px 8px;font-family:Arial,sans-serif;">
          <div style="color:#3c4043;font-size:14px;margin-bottom:20px;">To-do</div>
          <div style="background:#fff;border:1px solid #e0e0e0;border-radius:4px;padding:16px;margin-bottom:12px;color:#5f6368;font-size:13px;">No work due soon</div>
          <div style="display:flex;align-items:center;gap:10px;margin-top:20px;"><div style="width:18px;height:18px;border:2px solid #dadce0;border-top-color:#1967d2;border-radius:50%;animation:cspin .9s linear infinite;"></div><span style="color:#5f6368;font-size:13px;">Loading assignments...</span></div>
        </div>
      </div>
      <input id="coverPass" type="password" autocomplete="off" style="position:absolute;opacity:0;pointer-events:none;width:1px;height:1px;">`;
  } else if (type === 'docs') {
    cover.style.background = '#fff';
    cover.innerHTML = `
      <div style="width:100%;max-width:900px;font-family:Arial,sans-serif;">
        <div style="background:#fff;border-bottom:1px solid #e0e0e0;padding:8px 16px;display:flex;align-items:center;gap:12px;">
          <div style="width:28px;height:28px;background:#4285f4;border-radius:2px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:14px;">D</div>
          <div style="color:#3c4043;font-size:16px;">Untitled document</div>
        </div>
        <div style="padding:60px 120px;min-height:400px;background:#fff;">
          <div style="width:100%;height:12px;background:#f1f3f4;border-radius:4px;margin-bottom:12px;"></div>
          <div style="width:80%;height:12px;background:#f1f3f4;border-radius:4px;margin-bottom:12px;"></div>
          <div style="width:90%;height:12px;background:#f1f3f4;border-radius:4px;margin-bottom:24px;"></div>
          <div style="display:flex;gap:8px;align-items:center;"><div style="width:16px;height:16px;border:2px solid #dadce0;border-top-color:#4285f4;border-radius:50%;animation:cspin .9s linear infinite;"></div><span style="color:#80868b;font-size:12px;">Loading...</span></div>
        </div>
      </div>
      <input id="coverPass" type="password" autocomplete="off" style="position:absolute;opacity:0;pointer-events:none;width:1px;height:1px;">`;
  } else if (type === 'blank') {
    cover.style.background = '#fff';
    cover.innerHTML = `<input id="coverPass" type="password" autocomplete="off" style="position:absolute;opacity:0;pointer-events:none;width:1px;height:1px;">`;
  } else {
    // default loading spinner
    cover.style.background = '#f1f3f4';
    cover.innerHTML = `
      <div class="cover-spinner"></div>
      <div class="cover-text">Loading resources...</div>
      <input id="coverPass" type="password" autocomplete="off" style="position:absolute;opacity:0;pointer-events:none;width:1px;height:1px;">`;
  }
  // Re-attach password listener after rebuilding cover HTML
  const inp = document.getElementById('coverPass');
  if (inp) {
    inp.addEventListener('input', function() {
      if (this.value === currentPassword) unlock();
    });
  }
}


</script>
</body>
</html>
