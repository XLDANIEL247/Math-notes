<script src="https://cdn.jsdelivr.net/npm/@titaniumnetwork-dev/ultraviolet@3.2.6/dist/uv.bundle.js"></script>
<script src="uv.config.js"></script>

<script>
    async function openApp(url) {
        const frame = document.getElementById('app-frame');
        const overlay = document.getElementById('app-overlay');

        // This registers the 'engine' (sw.js)
        await navigator.serviceWorker.register('./sw.js', {
            scope: '/service/'
        });

        // This scrambles the URL and loads it through the proxy
        let encodedUrl = __uv$config.prefix + __uv$config.encodeUrl(url);
        frame.src = encodedUrl;
        overlay.style.display = 'block';
    }
</script>